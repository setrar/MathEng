{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "47bbf652-2734-4a15-a4dc-5669c940469d",
   "metadata": {},
   "source": [
    "# Sketch the convolution\n",
    "\n",
    "![image](images/Fig_sketch_convo.png)\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a6f7c66-5edf-43d2-a86d-8a2caf4a0cb5",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "f8e427f8-8ce7-4cfe-bd86-9682b4d620d4",
   "metadata": {},
   "source": [
    "# **Give the Inverse Laplace**\n",
    "\n",
    "\n",
    "$H(s) = \\frac{3s + 7}{s^2 - 2s - 3}$\n",
    "\n",
    "[5 points]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4e4e1de9-c994-485f-bc1a-d638e0725157",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "351cbf83-a728-4da4-a544-7e069e5a9058",
   "metadata": {},
   "source": [
    "# **Causal LTI**\n",
    "\n",
    "Input: \n",
    "$x[n] = \\left(\\frac{1}{2}\\right)^n u[n] - \\frac{1}{4} \\left( \\frac{1}{2}\\right)^{n-1} u[n-1]$\n",
    "\n",
    "as output:\n",
    "$y[n] = \\left(\\frac{1}{3}\\right)^n u[n]$\n",
    "\n",
    "$u[n]$ is the unit step function.\n",
    "\n",
    "Determine:\n",
    "- The transfer function $H(z)$\n",
    "- The impulse response $h[n]$\n",
    "- The corresponding difference equation\n",
    "\n",
    "Hint: Except for the scalar, the second component of $x[n]$ is identical to the 1st component with a unit delay.\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d58016fc-9c59-4f93-a6f0-05b6c619cdbd",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "14165b11-3f0b-4264-9b41-772e7c8656b6",
   "metadata": {},
   "source": [
    "# **Continuous-time signal**\n",
    "\n",
    "**Continuous-time signal** contains 2 frequencies\n",
    "\n",
    "$x_1 = 1605 \\text{ Hz}$\n",
    "\n",
    "$x_2 = 1645 \\text{ Hz}$\n",
    "\n",
    "sampled at $10 \\text{ kHz}$.\n",
    "\n",
    "Given 200 samples, state whether or not it is possible to resolve the two frequencies using DFT.\n",
    "\n",
    "Discuss leakage and windowing.\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c580e504-351c-4a24-82d8-0107f9069b75",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "c2c44948-0c18-477f-a4d7-cedf11b7bc8b",
   "metadata": {},
   "source": [
    "# PDF of\n",
    "\n",
    "$f(x) = A e^{- \\lambda x}$\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b92a19d-5181-4134-bc2d-13ce88459f77",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "Here is the probability density function (PDF) for the exponential distribution:\n",
    "\n",
    "$f(x) = \\begin{cases} A e^{-\\lambda x}, & x \\geq 0 \\\\ 0, & x < 0 \\end{cases}$\n",
    "\n",
    "where:  \n",
    "- $A$ is a scaling factor (often set to $\\lambda$ to ensure normalization).  \n",
    "- $\\lambda > 0$ is the rate parameter.\n",
    "\n",
    "If the function represents a valid probability density function, then it must satisfy the normalization condition:\n",
    "\n",
    "$\\int_0^\\infty A e^{-\\lambda x} \\, dx = 1$\n",
    "\n",
    "Solving for $A$:\n",
    "\n",
    "$A \\int_0^\\infty e^{-\\lambda x} \\, dx = 1$\n",
    "\n",
    "$A \\left[ \\frac{e^{-\\lambda x}}{-\\lambda} \\right]_0^\\infty = 1$\n",
    "\n",
    "$A \\left( 0 - \\left(-\\frac{1}{\\lambda}\\right) \\right) = 1$\n",
    "\n",
    "$A \\cdot \\frac{1}{\\lambda} = 1$\n",
    "\n",
    "$A = \\lambda$\n",
    "\n",
    "Thus, the standard form of the exponential distribution PDF is:\n",
    "\n",
    "$f(x) = \\begin{cases} \\lambda e^{-\\lambda x}, & x \\geq 0 \\\\ 0, & x < 0 \\end{cases}$\n",
    "\n",
    "Let me know if you need further clarifications!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "29dc678e-730e-4dc7-aa66-00e664841fdb",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "8e9fc919-b427-4f93-8745-3d3c26e78bef",
   "metadata": {},
   "source": [
    "# Linear Algebra 1\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c47822d-8ac9-4f60-9365-29cd84a7110c",
   "metadata": {},
   "source": [
    "To perform curve fitting using linear algebra, follow these steps:\n",
    "\n",
    "1. **Choose a Model**: Select a function to fit the data (e.g., linear, quadratic, exponential). Ensure the model is linear in its parameters (e.g., $y = mx + b$, $y = ax^2 + bx + c$, or linearized forms like $\\ln y = bx + c$ for exponentials).\n",
    "\n",
    "2. **Construct the Design Matrix (A)**:\n",
    "   - For a polynomial $y = a_0 + a_1x + \\dots + a_nx^n$, each row corresponds to a data point $(x_i, y_i)$ with entries $[x_i^n, x_i^{n-1}, \\dots, 1]$.\n",
    "   - Example (linear fit for points $(1,2), (2,3), (3,5)$):\n",
    "$A = \\begin{bmatrix} 1 & 1 \\\\ 2 & 1 \\\\ 3 & 1 \\end{bmatrix}, \\quad Y = \\begin{bmatrix} 2 \\\\ 3 \\\\ 5 \\end{bmatrix}$\n",
    "\n",
    "3. **Formulate the Normal Equations**:\n",
    "   - Compute $A^T A$ and $A^T Y$:\n",
    "$A^T A = \\begin{bmatrix} 14 & 6 \\\\ 6 & 3 \\end{bmatrix}, \\quad A^T Y = \\begin{bmatrix} 23 \\\\ 10 \\end{bmatrix}$\n",
    "   - Solve $(A^T A) \\mathbf{v} = A^T Y$ for coefficients $\\mathbf{v}$.\n",
    "\n",
    "4. **Solve for Coefficients**:\n",
    "   - Using elimination or matrix inversion:\n",
    "$\\mathbf{v} = (A^T A)^{-1} A^T Y$\n",
    "   - For the example, solving gives $m = 1.5$, $b = \\frac{1}{3}$.\n",
    "\n",
    "5. **Verify and Use the Model**:\n",
    "   - Plug coefficients into the model (e.g., $y = 1.5x + \\frac{1}{3}$).\n",
    "   - Check residuals to assess fit quality.\n",
    "\n",
    "**Generalization to Higher Degrees**:\n",
    "- For a quadratic fit, include $x^2$ terms in $A$:\n",
    "$A = \\begin{bmatrix} 1 & 1 & 1 \\\\ 4 & 2 & 1 \\\\ 9 & 3 & 1 \\\\ 16 & 4 & 1 \\end{bmatrix}, \\quad Y = \\begin{bmatrix} 3 \\\\ 5 \\\\ 6 \\\\ 5 \\end{bmatrix}$\n",
    "- Solve similarly to find coefficients $a, b, c$.\n",
    "\n",
    "**Key Considerations**:\n",
    "- **Numerical Stability**: Use QR decomposition or SVD for ill-conditioned matrices.\n",
    "- **Nonlinear Models**: Linearize where possible (e.g., log transforms for exponentials).\n",
    "\n",
    "**Final Answer**:\n",
    "Linear algebra facilitates curve fitting by solving the normal equations $A^T A \\mathbf{v} = A^T Y$, yielding coefficients that minimize the sum of squared residuals. For a best-fit line $y = mx + b$ through points $(1,2), (2,3), (3,5)$, the solution is $\\boxed{y = \\frac{3}{2}x + \\frac{1}{3}}$."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1076473-94b7-4fd0-bdce-a38fdc9e20fb",
   "metadata": {},
   "source": [
    "# Linear Algebra 2\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5fd724e6-5a28-40a2-82b3-c576c9df730b",
   "metadata": {},
   "source": [
    "No need to apologize! Letâ€™s clarify **null space** and **free variables** with an example to solidify your understanding. ðŸ˜Š\n",
    "\n",
    "---\n",
    "\n",
    "### **1. Null Space (Kernel)**  \n",
    "**Definition**:  \n",
    "The **null space** of a matrix $A$, written as $\\text{Null}(A)$, is the set of **all vectors $\\mathbf{x}$** such that:  \n",
    "$\n",
    "A\\mathbf{x} = \\mathbf{0}\n",
    "$  \n",
    "It represents all solutions to the homogeneous system $A\\mathbf{x} = \\mathbf{0}$.  \n",
    "\n",
    "**Key Idea**:  \n",
    "- The null space is a **subspace** (closed under addition/scalar multiplication).  \n",
    "- Its dimension is called the **nullity** of $A$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **2. Free Variables**  \n",
    "**Definition**:  \n",
    "**Free variables** are the variables in a system of equations that are **not constrained by pivots** (leading variables) after row-reducing $A$. They can take **any value**, and other variables depend on them.  \n",
    "\n",
    "**Key Idea**:  \n",
    "- Free variables act as **parameters** to describe infinite solutions.  \n",
    "- The number of free variables equals the **nullity** of $A$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **Example: Connecting Null Space and Free Variables**  \n",
    "Consider the matrix:  \n",
    "$\n",
    "A = \\begin{bmatrix}\n",
    "1 & 2 & -1 \\\\\n",
    "3 & 6 & -3\n",
    "\\end{bmatrix}\n",
    "$  \n",
    "**Step 1: Row-reduce $A$**  \n",
    "$\n",
    "\\text{RREF}(A) = \\begin{bmatrix}\n",
    "1 & 2 & -1 \\\\\n",
    "0 & 0 & 0\n",
    "\\end{bmatrix}\n",
    "$  \n",
    "**Step 2: Identify Variables**  \n",
    "- Pivot variable: $x_1$ (corresponds to the leading 1).  \n",
    "- Free variables: $x_2$ and $x_3$.  \n",
    "\n",
    "**Step 3: Express Solutions**  \n",
    "Let $x_2 = s$ and $x_3 = t$ (free variables). Then:  \n",
    "$\n",
    "x_1 = -2s + t\n",
    "$  \n",
    "The general solution (null space) is:  \n",
    "$\n",
    "\\mathbf{x} = s \\begin{bmatrix} -2 \\\\ 1 \\\\ 0 \\end{bmatrix} + t \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}\n",
    "$  \n",
    "**Null Space**: All linear combinations of these two vectors.  \n",
    "**Nullity**: $2$ (since there are 2 free variables).  \n",
    "\n",
    "---\n",
    "\n",
    "### **Connection to Rank-Nullity Theorem**  \n",
    "For an $m \\times n$ matrix $A$:  \n",
    "$\n",
    "\\text{rank}(A) + \\text{nullity}(A) = n\n",
    "$  \n",
    "- **Rank**: Number of pivots (here, $\\text{rank}(A) = 1$).  \n",
    "- **Nullity**: Number of free variables (here, $2$).  \n",
    "- Check: $1 + 2 = 3$, which matches $n = 3$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **Why This Matters**  \n",
    "- **Null Space**: Reveals \"hidden\" solutions to $A\\mathbf{x} = \\mathbf{0}$, useful in physics, engineering, and optimization.  \n",
    "- **Free Variables**: Simplify solving underdetermined systems (e.g., in least-squares problems).  \n",
    "\n",
    "---\n",
    "\n",
    "### **Summary**  \n",
    "- **Null Space** = All solutions to $A\\mathbf{x} = \\mathbf{0}$.  \n",
    "- **Free Variables** = Parameters that define the null space.  \n",
    "- **Nullity** = Number of free variables = Dimension of the null space.  \n",
    "\n",
    "Let me know if youâ€™d like another example or deeper intuition! ðŸš€"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a081da13-6a59-49c8-b534-861a4db001bd",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Julia 1.11.3",
   "language": "julia",
   "name": "julia-1.11"
  },
  "language_info": {
   "file_extension": ".jl",
   "mimetype": "application/julia",
   "name": "julia",
   "version": "1.11.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
