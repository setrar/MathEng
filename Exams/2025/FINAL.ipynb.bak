{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "47bbf652-2734-4a15-a4dc-5669c940469d",
   "metadata": {},
   "source": [
    "# Sketch the convolution\n",
    "\n",
    "![image](images/Fig_sketch_convo.png)\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a6f7c66-5edf-43d2-a86d-8a2caf4a0cb5",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "f8e427f8-8ce7-4cfe-bd86-9682b4d620d4",
   "metadata": {},
   "source": [
    "# **Give the Inverse Laplace**\n",
    "\n",
    "\n",
    "$H(s) = \\frac{3s + 7}{s^2 - 2s - 3}$\n",
    "\n",
    "[5 points]\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8b445d0-c580-4c65-9e68-29d422802cdc",
   "metadata": {},
   "source": [
    "---\n",
    "To find the inverse Laplace transform of:\n",
    "\n",
    "$H(s) = \\frac{3s + 7}{s^2 - 2s - 3}$\n",
    "\n",
    "### **Step 1: Factor the Denominator**\n",
    "Factor the quadratic denominator:\n",
    "\n",
    "$s^2 - 2s - 3 = (s - 3)(s + 1)$\n",
    "\n",
    "Thus, we rewrite:\n",
    "\n",
    "$H(s) = \\frac{3s + 7}{(s - 3)(s + 1)}$\n",
    "\n",
    "### **Step 2: Perform Partial Fraction Decomposition**\n",
    "We assume:\n",
    "\n",
    "$\\frac{3s + 7}{(s - 3)(s + 1)} = \\frac{A}{s - 3} + \\frac{B}{s + 1}$\n",
    "\n",
    "Multiply both sides by $(s - 3)(s + 1)$ to eliminate the denominators:\n",
    "\n",
    "$3s + 7 = A(s + 1) + B(s - 3)$\n",
    "\n",
    "Expand:\n",
    "\n",
    "$3s + 7 = A s + A + B s - 3B$\n",
    "\n",
    "$3s + 7 = (A + B)s + (A - 3B)$\n",
    "\n",
    "### **Step 3: Solve for $A$ and $B$**\n",
    "By comparing coefficients:\n",
    "\n",
    "1. $A + B = 3$  (coefficient of $s$)\n",
    "2. $A - 3B = 7$  (constant term)\n",
    "\n",
    "Solve the system:\n",
    "\n",
    "- From $A = 3 - B$, substitute into the second equation:\n",
    "\n",
    "$\\begin{align} \n",
    "(3 - B) - 3B &= 7 \\\\ \n",
    "3 - B - 3B &= 7 \\\\ \n",
    "3 - 4B &= 7 \\\\\n",
    "-4B &= 4 \\\\\n",
    "B &= -1 \n",
    "\\end{align}$\n",
    "\n",
    "- Substitute $B = -1$ into $A = 3 - B$:\n",
    "\n",
    "$A = 3 - (-1) = 4$\n",
    "\n",
    "### **Step 4: Take the Inverse Laplace Transform**\n",
    "Now we rewrite:\n",
    "\n",
    "$H(s) = \\frac{4}{s - 3} - \\frac{1}{s + 1}$\n",
    "\n",
    "Using known inverse Laplace transforms:\n",
    "\n",
    "$\\mathcal{L}^{-1} \\left( \\frac{1}{s - a} \\right) = e^{at}$\n",
    "\n",
    "we get:\n",
    "\n",
    "$h(t) = 4e^{3t} - e^{-t}, \\quad t \\geq 0$\n",
    "\n",
    "### **Final Answer:**\n",
    "$h(t) = 4e^{3t} - e^{-t}, \\quad t \\geq 0$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "351cbf83-a728-4da4-a544-7e069e5a9058",
   "metadata": {},
   "source": [
    "# **Causal LTI**\n",
    "\n",
    "Input: \n",
    "$x[n] = \\left(\\frac{1}{2}\\right)^n u[n] - \\frac{1}{4} \\left( \\frac{1}{2}\\right)^{n-1} u[n-1]$\n",
    "\n",
    "as output:\n",
    "$y[n] = \\left(\\frac{1}{3}\\right)^n u[n]$\n",
    "\n",
    "$u[n]$ is the unit step function.\n",
    "\n",
    "Determine:\n",
    "- The transfer function $H(z)$\n",
    "- The impulse response $h[n]$\n",
    "- The corresponding difference equation\n",
    "\n",
    "Hint: Except for the scalar, the second component of $x[n]$ is identical to the 1st component with a unit delay.\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "089f46eb-9087-47c7-a7d6-d829f5100f19",
   "metadata": {},
   "source": [
    "---\n",
    "To analyze the causal LTI system given by:\n",
    "\n",
    "$x[n] = \\left(\\frac{1}{2}\\right)^n u[n] - \\frac{1}{4} \\left( \\frac{1}{2}\\right)^{n-1} u[n-1]$\n",
    "\n",
    "which produces the output:\n",
    "\n",
    "$y[n] = \\left(\\frac{1}{3}\\right)^n u[n]$\n",
    "\n",
    "we will determine the transfer function $H(z)$, the impulse response $h[n]$, and the difference equation.\n",
    "\n",
    "### **Step 1: Compute the Z-transform of $x[n]$ and $y[n]$**\n",
    "The **Z-transform** of a geometric sequence:\n",
    "\n",
    "$\\mathcal{Z} \\left[ a^n u[n] \\right] = \\frac{1}{1 - a z^{-1}}, \\quad |z| > |a|$\n",
    "\n",
    "Applying this to each term in $x[n]$:\n",
    "\n",
    "1. **First term:**\n",
    "$\\mathcal{Z} \\left[ \\left(\\frac{1}{2}\\right)^n u[n] \\right] = \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "2. **Second term:**\n",
    "$\\mathcal{Z} \\left[ \\frac{1}{4} \\left( \\frac{1}{2} \\right)^{n-1} u[n-1] \\right]$\n",
    "\n",
    "   - Recognizing that $u[n-1]$ introduces a **unit delay** (multiplication by $z^{-1}$ in the Z-domain):\n",
    "\n",
    "$\\mathcal{Z} \\left[ \\left(\\frac{1}{2}\\right)^n u[n] \\right] = \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "     So the delayed version is:\n",
    "\n",
    "$z^{-1} \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "   - Multiplying by $\\frac{1}{4}$:\n",
    "\n",
    "$\\frac{1}{4} z^{-1} \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "Thus, the Z-transform of $x[n]$ is:\n",
    "\n",
    "$X(z) = \\frac{1}{1 - \\frac{1}{2} z^{-1}} - \\frac{1}{4} z^{-1} \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "Factoring:\n",
    "\n",
    "$X(z) = \\left( 1 - \\frac{1}{4} z^{-1} \\right) \\frac{1}{1 - \\frac{1}{2} z^{-1}}$\n",
    "\n",
    "For $y[n]$:\n",
    "\n",
    "$Y(z) = \\frac{1}{1 - \\frac{1}{3} z^{-1}}$\n",
    "\n",
    "### **Step 2: Compute the Transfer Function $H(z)$**\n",
    "The transfer function is:\n",
    "\n",
    "$H(z) = \\frac{Y(z)}{X(z)}$\n",
    "\n",
    "$H(z) = \\frac{\\frac{1}{1 - \\frac{1}{3} z^{-1}}}{\\left(1 - \\frac{1}{4} z^{-1} \\right) \\frac{1}{1 - \\frac{1}{2} z^{-1}}}$\n",
    "\n",
    "$H(z) = \\frac{(1 - \\frac{1}{2} z^{-1})}{(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1})}$\n",
    "\n",
    "### **Step 3: Compute the Impulse Response $h[n]$**\n",
    "Since:\n",
    "\n",
    "$H(z) = \\frac{(1 - \\frac{1}{2} z^{-1})}{(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1})}$\n",
    "\n",
    "We perform **partial fraction expansion**:\n",
    "\n",
    "$\\frac{(1 - \\frac{1}{2} z^{-1})}{(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1})} = \\frac{A}{1 - \\frac{1}{4} z^{-1}} + \\frac{B}{1 - \\frac{1}{3} z^{-1}}$\n",
    "\n",
    "Multiplying by $(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1})$, we get:\n",
    "\n",
    "$1 - \\frac{1}{2} z^{-1} = A(1 - \\frac{1}{3} z^{-1}) + B(1 - \\frac{1}{4} z^{-1})$\n",
    "\n",
    "Expanding:\n",
    "\n",
    "$1 - \\frac{1}{2} z^{-1} = A - \\frac{A}{3} z^{-1} + B - \\frac{B}{4} z^{-1}$\n",
    "\n",
    "Grouping terms:\n",
    "\n",
    "$( A + B ) + \\left( -\\frac{A}{3} - \\frac{B}{4} \\right) z^{-1} = 1 - \\frac{1}{2} z^{-1}$\n",
    "\n",
    "Solving for $A$ and $B$:\n",
    "\n",
    "1. $A + B = 1$\n",
    "2. $-\\frac{A}{3} - \\frac{B}{4} = -\\frac{1}{2}$\n",
    "\n",
    "Solve for $A$ and $B$:\n",
    "\n",
    "From $A + B = 1$, we express $B$ as:\n",
    "\n",
    "$B = 1 - A$\n",
    "\n",
    "Substituting into the second equation:\n",
    "\n",
    "$-\\frac{A}{3} - \\frac{(1 - A)}{4} = -\\frac{1}{2}$\n",
    "\n",
    "Multiplying by 12 to clear fractions:\n",
    "\n",
    "$\\begin{align*} -4A - 3 + 3A = -6 \\\\ -4A + 3A = -3 \\\\ - A = -3 \\\\ A = 3 \\end{align*}$\n",
    "\n",
    "$B = 1 - 3 = -2$\n",
    "\n",
    "Thus:\n",
    "\n",
    "$H(z) = \\frac{3}{1 - \\frac{1}{4} z^{-1}} - \\frac{2}{1 - \\frac{1}{3} z^{-1}}$\n",
    "\n",
    "Taking inverse Z-transform:\n",
    "\n",
    "$h[n] = 3 \\left(\\frac{1}{4}\\right)^n u[n] - 2 \\left(\\frac{1}{3}\\right)^n u[n]$\n",
    "\n",
    "### **Step 4: Find the Difference Equation**\n",
    "From:\n",
    "\n",
    "$Y(z) = H(z) X(z)$\n",
    "\n",
    "$(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1}) Y(z) = (1 - \\frac{1}{2} z^{-1}) X(z)$\n",
    "\n",
    "Taking the inverse Z-transform:\n",
    "\n",
    "$y[n] - \\frac{1}{4} y[n-1] - \\frac{1}{3} y[n-1] + \\frac{1}{12} y[n-2] = x[n] - \\frac{1}{2} x[n-1]$\n",
    "\n",
    "$y[n] - \\frac{7}{12} y[n-1] + \\frac{1}{12} y[n-2] = x[n] - \\frac{1}{2} x[n-1]$\n",
    "\n",
    "### **Final Answers:**\n",
    "1. **Transfer Function:**\n",
    "$\\boxed{ H(z) = \\frac{(1 - \\frac{1}{2} z^{-1})}{(1 - \\frac{1}{4} z^{-1})(1 - \\frac{1}{3} z^{-1})} }$\n",
    "\n",
    "2. **Impulse Response:**\n",
    "$\\boxed{ h[n] = 3 \\left(\\frac{1}{4}\\right)^n u[n] - 2 \\left(\\frac{1}{3}\\right)^n u[n] }$\n",
    "\n",
    "3. **Difference Equation:**\n",
    "$\\boxed{ y[n] - \\frac{7}{12} y[n-1] + \\frac{1}{12} y[n-2] = x[n] - \\frac{1}{2} x[n-1] }$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "14165b11-3f0b-4264-9b41-772e7c8656b6",
   "metadata": {},
   "source": [
    "# **Continuous-time signal**\n",
    "\n",
    "**Continuous-time signal** contains 2 frequencies\n",
    "\n",
    "$x_1 = 1605 \\text{ Hz}$\n",
    "\n",
    "$x_2 = 1645 \\text{ Hz}$\n",
    "\n",
    "sampled at $10 \\text{ kHz}$.\n",
    "\n",
    "Given 200 samples, state whether or not it is possible to resolve the two frequencies using DFT.\n",
    "\n",
    "Discuss leakage and windowing.\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "296d0808-db8e-4518-ad0e-f00a990c9382",
   "metadata": {},
   "source": [
    "To determine whether it is possible to resolve the two frequencies using the **Discrete Fourier Transform (DFT)**, we analyze the resolution, spectral leakage, and windowing effects.\n",
    "\n",
    "---\n",
    "\n",
    "### **Step 1: Frequency Resolution of the DFT**\n",
    "The frequency resolution of a DFT is given by:\n",
    "\n",
    "$\\Delta f = \\frac{f_s}{N}$\n",
    "\n",
    "where:\n",
    "- $f_s = 10$ kHz is the sampling frequency,\n",
    "- $N = 200$ is the number of samples.\n",
    "\n",
    "$\\Delta f = \\frac{10,000}{200} = 50 \\text{ Hz}$\n",
    "\n",
    "The two signal frequencies are:\n",
    "- $x_1 = 1605$ Hz\n",
    "- $x_2 = 1645$ Hz\n",
    "\n",
    "The frequency separation is:\n",
    "\n",
    "$\\Delta x = 1645 - 1605 = 40 \\text{ Hz}$\n",
    "\n",
    "Since the separation ($40$ Hz) is **smaller** than the DFT resolution ($50$ Hz), **the two frequencies cannot be resolved using a 200-point DFT**.\n",
    "\n",
    "---\n",
    "\n",
    "### **Step 2: Spectral Leakage and Windowing**\n",
    "- **Spectral leakage** occurs when a signalâ€™s frequency components do not align exactly with the DFT bin centers. This results in energy spreading across neighboring bins, making it harder to distinguish closely spaced frequencies.\n",
    "- In our case, **1605 Hz and 1645 Hz do not align with 50 Hz bins**, causing significant spectral leakage.\n",
    "- **Windowing** techniques (such as Hamming, Hanning, or Blackman) help reduce leakage but come at the cost of widening the main lobe in the frequency domain, further reducing the ability to resolve close frequencies.\n",
    "\n",
    "---\n",
    "\n",
    "### **Conclusion**\n",
    "- The two frequencies **cannot be resolved** using a 200-point DFT due to insufficient frequency resolution ($\\Delta f = 50$ Hz vs. $\\Delta x = 40$ Hz).\n",
    "- Spectral leakage will further blur the distinction between the two frequencies.\n",
    "- Using **zero-padding** (increasing $N$) or a **longer data record** would improve resolution.\n",
    "- **Applying a window function** can reduce leakage but will also slightly widen peaks, making resolution harder.\n",
    "\n",
    "Thus, a **larger $N$** (e.g., 250 or more) is needed to reliably separate the two frequencies."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c2c44948-0c18-477f-a4d7-cedf11b7bc8b",
   "metadata": {},
   "source": [
    "# PDF of\n",
    "\n",
    "$f(x) = A e^{- \\lambda x}$\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b92a19d-5181-4134-bc2d-13ce88459f77",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "### probability density function (PDF)\n",
    "\n",
    "Here is the probability density function (PDF) for the exponential distribution:\n",
    "\n",
    "$f(x) = \\begin{cases} A e^{-\\lambda x}, & x \\geq 0 \\\\ 0, & x < 0 \\end{cases}$\n",
    "\n",
    "where:  \n",
    "- $A$ is a scaling factor (often set to $\\lambda$ to ensure normalization).  \n",
    "- $\\lambda > 0$ is the rate parameter.\n",
    "\n",
    "If the function represents a valid probability density function, then it must satisfy the normalization condition:\n",
    "\n",
    "$\\int_0^\\infty A e^{-\\lambda x} \\, dx = 1$\n",
    "\n",
    "Solving for $A$:\n",
    "\n",
    "$A \\int_0^\\infty e^{-\\lambda x} \\, dx = 1$\n",
    "\n",
    "$A \\left[ \\frac{e^{-\\lambda x}}{-\\lambda} \\right]_0^\\infty = 1$\n",
    "\n",
    "$A \\left( 0 - \\left(-\\frac{1}{\\lambda}\\right) \\right) = 1$\n",
    "\n",
    "$A \\cdot \\frac{1}{\\lambda} = 1$\n",
    "\n",
    "$A = \\lambda$\n",
    "\n",
    "Thus, the standard form of the exponential distribution PDF is:\n",
    "\n",
    "$f(x) = \\begin{cases} \\lambda e^{-\\lambda x}, & x \\geq 0 \\\\ 0, & x < 0 \\end{cases}$\n",
    "\n",
    "### Usage\n",
    "\n",
    "The function  \n",
    "\n",
    "$f(x) = A e^{-\\lambda x}$\n",
    "\n",
    "appears in various fields, particularly in **probability theory**, **physics**, **engineering**, and **signal processing**. Here are some common contexts:\n",
    "\n",
    "#### **1. Probability and Statistics**\n",
    "- **Exponential Distribution**:  \n",
    "  When $A = \\lambda$ and $x \\geq 0$, this represents the probability density function (PDF) of an **exponential distribution**:\n",
    "  \n",
    "$f(x) = \\lambda e^{-\\lambda x}, \\quad x \\geq 0$\n",
    "  \n",
    "  - Used to model **waiting times** (e.g., time between arrivals in a Poisson process).\n",
    "  - Appears in **reliability analysis** (e.g., time until failure of a system).\n",
    "\n",
    "### **2. Engineering and Signal Processing**\n",
    "- **Impulse Response of an RC Circuit**:\n",
    "  - The voltage or current response of a first-order low-pass filter follows an exponential decay.\n",
    "  \n",
    "- **Damping in Mechanical and Electrical Systems**:\n",
    "  - In damped oscillatory systems, the envelope of oscillations is often modeled as $A e^{-\\lambda x}$.\n",
    "\n",
    "- **Fourier and Laplace Transforms**:\n",
    "  - Appears in the Laplace transform of simple decaying exponentials:\n",
    "  \n",
    "$\\mathcal{L} \\{ e^{-\\lambda x} \\} = \\frac{1}{s + \\lambda}$\n",
    "\n",
    "### **4. Economics**\n",
    "- **Discounted Cash Flow (DCF)**:\n",
    "  - In finance, future cash flows are discounted using an exponential decay factor.\n",
    "\n",
    "---\n",
    "\n",
    "### **Conclusion**\n",
    "The function $f(x) = A e^{-\\lambda x}$ is widely used in modeling **decay, probability distributions, filtering, and damping** in multiple disciplines."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8e9fc919-b427-4f93-8745-3d3c26e78bef",
   "metadata": {},
   "source": [
    "# Linear Algebra 1\n",
    "\n",
    "[4 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c47822d-8ac9-4f60-9365-29cd84a7110c",
   "metadata": {},
   "source": [
    "---\n",
    "To perform curve fitting using linear algebra, follow these steps:\n",
    "\n",
    "1. **Choose a Model**: Select a function to fit the data (e.g., linear, quadratic, exponential). Ensure the model is linear in its parameters (e.g., $y = mx + b$, $y = ax^2 + bx + c$, or linearized forms like $\\ln y = bx + c$ for exponentials).\n",
    "\n",
    "2. **Construct the Design Matrix (A)**:\n",
    "   - For a polynomial $y = a_0 + a_1x + \\dots + a_nx^n$, each row corresponds to a data point $(x_i, y_i)$ with entries $[x_i^n, x_i^{n-1}, \\dots, 1]$.\n",
    "   - Example (linear fit for points $(1,2), (2,3), (3,5)$):\n",
    "$A = \\begin{bmatrix} 1 & 1 \\\\ 2 & 1 \\\\ 3 & 1 \\end{bmatrix}, \\quad Y = \\begin{bmatrix} 2 \\\\ 3 \\\\ 5 \\end{bmatrix}$\n",
    "\n",
    "3. **Formulate the Normal Equations**:\n",
    "   - Compute $A^T A$ and $A^T Y$:\n",
    "$A^T A = \\begin{bmatrix} 14 & 6 \\\\ 6 & 3 \\end{bmatrix}, \\quad A^T Y = \\begin{bmatrix} 23 \\\\ 10 \\end{bmatrix}$\n",
    "   - Solve $(A^T A) \\mathbf{v} = A^T Y$ for coefficients $\\mathbf{v}$.\n",
    "\n",
    "4. **Solve for Coefficients**:\n",
    "   - Using elimination or matrix inversion:\n",
    "$\\mathbf{v} = (A^T A)^{-1} A^T Y$\n",
    "   - For the example, solving gives $m = 1.5$, $b = \\frac{1}{3}$.\n",
    "\n",
    "5. **Verify and Use the Model**:\n",
    "   - Plug coefficients into the model (e.g., $y = 1.5x + \\frac{1}{3}$).\n",
    "   - Check residuals to assess fit quality.\n",
    "\n",
    "**Generalization to Higher Degrees**:\n",
    "- For a quadratic fit, include $x^2$ terms in $A$:\n",
    "$A = \\begin{bmatrix} 1 & 1 & 1 \\\\ 4 & 2 & 1 \\\\ 9 & 3 & 1 \\\\ 16 & 4 & 1 \\end{bmatrix}, \\quad Y = \\begin{bmatrix} 3 \\\\ 5 \\\\ 6 \\\\ 5 \\end{bmatrix}$\n",
    "- Solve similarly to find coefficients $a, b, c$.\n",
    "\n",
    "**Key Considerations**:\n",
    "- **Numerical Stability**: Use QR decomposition or SVD for ill-conditioned matrices.\n",
    "- **Nonlinear Models**: Linearize where possible (e.g., log transforms for exponentials).\n",
    "\n",
    "**Final Answer**:\n",
    "Linear algebra facilitates curve fitting by solving the normal equations $A^T A \\mathbf{v} = A^T Y$, yielding coefficients that minimize the sum of squared residuals. For a best-fit line $y = mx + b$ through points $(1,2), (2,3), (3,5)$, the solution is $\\boxed{y = \\frac{3}{2}x + \\frac{1}{3}}$.\n",
    "\n",
    "## relationship between **curve fitting**, **linear algebra**\n",
    "\n",
    "The relationship between **curve fitting**, **linear algebra**, and **least squares** lies in how we approximate data with a mathematical model by minimizing errors. Here's a breakdown:\n",
    "\n",
    "#### **1. Curve Fitting and Least Squares**\n",
    "- Curve fitting aims to find a function $f(x)$ that best represents a set of data points $(x_i, y_i)$.\n",
    "- If the relationship is **linear in parameters**, we can express it as:\n",
    "\n",
    "  $\n",
    "  y = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\dots + \\beta_n x^n + \\epsilon\n",
    "  $\n",
    "\n",
    "  where $\\epsilon$ is the error term.\n",
    "- The **least squares method** minimizes the sum of squared errors:\n",
    "\n",
    "  $\n",
    "  S = \\sum_{i=1}^{N} (y_i - f(x_i))^2\n",
    "  $\n",
    "\n",
    "  ensuring the best fit.\n",
    "\n",
    "#### **2. Linear Algebra Representation**\n",
    "- We rewrite the problem in matrix form:\n",
    "\n",
    "  $\n",
    "  \\mathbf{Y} = \\mathbf{X} \\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n",
    "  $\n",
    "\n",
    "  where:\n",
    "  - $\\mathbf{Y}$ is the vector of observed values $y_i$,\n",
    "  - $\\mathbf{X}$ is the **design matrix** containing the input data,\n",
    "  - $\\boldsymbol{\\beta}$ is the vector of unknown parameters,\n",
    "  - $\\boldsymbol{\\epsilon}$ is the error vector.\n",
    "\n",
    "- **Example for a linear model** $y = \\beta_0 + \\beta_1 x$:\n",
    "\n",
    "  $\n",
    "  \\begin{bmatrix}\n",
    "  y_1 \\\\\n",
    "  y_2 \\\\\n",
    "  \\vdots \\\\\n",
    "  y_N\n",
    "  \\end{bmatrix}\n",
    "  =\n",
    "  \\begin{bmatrix}\n",
    "  1 & x_1 \\\\\n",
    "  1 & x_2 \\\\\n",
    "  \\vdots & \\vdots \\\\\n",
    "  1 & x_N\n",
    "  \\end{bmatrix}\n",
    "  \\begin{bmatrix}\n",
    "  \\beta_0 \\\\\n",
    "  \\beta_1\n",
    "  \\end{bmatrix}\n",
    "  +\n",
    "  \\begin{bmatrix}\n",
    "  \\epsilon_1 \\\\\n",
    "  \\epsilon_2 \\\\\n",
    "  \\vdots \\\\\n",
    "  \\epsilon_N\n",
    "  \\end{bmatrix}\n",
    "  $\n",
    "\n",
    "#### **3. Solving for $\\boldsymbol{\\beta}$ using Least Squares**\n",
    "- The least squares solution minimizes:\n",
    "\n",
    "  $\n",
    "  S = \\| \\mathbf{Y} - \\mathbf{X} \\boldsymbol{\\beta} \\|^2\n",
    "  $\n",
    "\n",
    "  The optimal parameters satisfy the **normal equation**:\n",
    "\n",
    "  $\n",
    "  (\\mathbf{X}^T \\mathbf{X}) \\boldsymbol{\\beta} = \\mathbf{X}^T \\mathbf{Y}\n",
    "  $\n",
    "\n",
    "  - If $\\mathbf{X}^T \\mathbf{X}$ is invertible, the solution is:\n",
    "\n",
    "    $\n",
    "    \\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{Y}\n",
    "    $\n",
    "\n",
    "  - If not, we use **QR decomposition** or **singular value decomposition (SVD)**.\n",
    "\n",
    "#### **4. Generalization to Nonlinear Models**\n",
    "- Some models, like $y = A e^{-\\lambda x}$, are **nonlinear in parameters**.\n",
    "- We can linearize them (e.g., using logarithms) or use **nonlinear least squares** (e.g., Levenberg-Marquardt).\n",
    "\n",
    "#### **Summary**\n",
    "- **Curve fitting** finds an approximate function for given data.\n",
    "- **Least squares** minimizes the error between the model and data.\n",
    "- **Linear algebra** (matrices & normal equations) provides an efficient way to solve for parameters.\n",
    "- **For linear models**, the solution is direct via $\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{Y}$.\n",
    "- **For nonlinear models**, iterative methods like gradient descent or Gauss-Newton are used.\n",
    "\n",
    "Would you like an example implementation in Python or Julia? ðŸš€"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d1076473-94b7-4fd0-bdce-a38fdc9e20fb",
   "metadata": {},
   "source": [
    "# Linear Algebra 2\n",
    "\n",
    "[8 points]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5fd724e6-5a28-40a2-82b3-c576c9df730b",
   "metadata": {},
   "source": [
    "---\n",
    "\n",
    "### **1. Null Space (Kernel)**  \n",
    "**Definition**:  \n",
    "The **null space** of a matrix $A$, written as $\\text{Null}(A)$, is the set of **all vectors $\\mathbf{x}$** such that:  \n",
    "$A\\mathbf{x} = \\mathbf{0}$\n",
    "It represents all solutions to the homogeneous system $A\\mathbf{x} = \\mathbf{0}$.  \n",
    "\n",
    "**Key Idea**:  \n",
    "- The null space is a **subspace** (closed under addition/scalar multiplication).  \n",
    "- Its dimension is called the **nullity** of $A$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **2. Free Variables**  \n",
    "**Definition**:  \n",
    "**Free variables** are the variables in a system of equations that are **not constrained by pivots** (leading variables) after row-reducing $A$. They can take **any value**, and other variables depend on them.  \n",
    "\n",
    "**Key Idea**:  \n",
    "- Free variables act as **parameters** to describe infinite solutions.  \n",
    "- The number of free variables equals the **nullity** of $A$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **Example: Connecting Null Space and Free Variables**  \n",
    "Consider the matrix:  \n",
    "$A = \\begin{bmatrix} 1 & 2 & -1 \\\\ 3 & 6 & -3 \\end{bmatrix}$\n",
    "**Step 1: Row-reduce $A$**  \n",
    "$\\text{RREF}(A) = \\begin{bmatrix} 1 & 2 & -1 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n",
    "**Step 2: Identify Variables**  \n",
    "- Pivot variable: $x_1$ (corresponds to the leading 1).  \n",
    "- Free variables: $x_2$ and $x_3$.  \n",
    "\n",
    "**Step 3: Express Solutions**  \n",
    "Let $x_2 = s$ and $x_3 = t$ (free variables). Then:  \n",
    "$x_1 = -2s + t$\n",
    "The general solution (null space) is:  \n",
    "$\\mathbf{x} = s \\begin{bmatrix} -2 \\\\ 1 \\\\ 0 \\end{bmatrix} + t \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$\n",
    "**Null Space**: All linear combinations of these two vectors.  \n",
    "**Nullity**: $2$ (since there are 2 free variables).  \n",
    "\n",
    "---\n",
    "\n",
    "### **Connection to Rank-Nullity Theorem**  \n",
    "For an $m \\times n$ matrix $A$:  \n",
    "$\\text{rank}(A) + \\text{nullity}(A) = n$\n",
    "- **Rank**: Number of pivots (here, $\\text{rank}(A) = 1$).  \n",
    "- **Nullity**: Number of free variables (here, $2$).  \n",
    "- Check: $1 + 2 = 3$, which matches $n = 3$.  \n",
    "\n",
    "---\n",
    "\n",
    "### **Why This Matters**  \n",
    "- **Null Space**: Reveals \"hidden\" solutions to $A\\mathbf{x} = \\mathbf{0}$, useful in physics, engineering, and optimization.  \n",
    "- **Free Variables**: Simplify solving underdetermined systems (e.g., in least-squares problems).  \n",
    "\n",
    "---\n",
    "\n",
    "### **Summary**  \n",
    "- **Null Space** = All solutions to $A\\mathbf{x} = \\mathbf{0}$.  \n",
    "- **Free Variables** = Parameters that define the null space.  \n",
    "- **Nullity** = Number of free variables = Dimension of the null space.  \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a081da13-6a59-49c8-b534-861a4db001bd",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Julia 1.11.3",
   "language": "julia",
   "name": "julia-1.11"
  },
  "language_info": {
   "file_extension": ".jl",
   "mimetype": "application/julia",
   "name": "julia",
   "version": "1.11.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
